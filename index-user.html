<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>Apple Store</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"/>
</head>

<body class="h-[100dvh] bg-gray-100 overflow-hidden font-sans text-sm">

<div class="flex h-full">

  <!-- OVERLAY MOBILE -->
  <div id="overlay"
       onclick="toggleSidebar()"
       class="fixed inset-0 bg-black/40 z-20 hidden md:hidden"></div>

  <!-- SIDEBAR -->
  <aside id="sidebar"
    class="fixed md:static z-30 w-64 h-full bg-white border-r flex flex-col
           -translate-x-full md:translate-x-0 transition-transform duration-300">

    <!-- LOGO -->
    <div class="flex items-center gap-3 px-6 py-5 border-b">
      <div class="w-10 h-10 bg-green-600 rounded-xl flex items-center justify-center text-white font-bold">
        <i class="fa-brands fa-apple text-xl"></i>
      </div>
      <div>
        <div class="font-bold text-gray-800 tracking-wide">APPLE SHOP</div>
        <div class="text-xs text-gray-400">Employee Portal</div>
      </div>
    </div>

    <!-- MENU -->
    <nav class="flex-1 px-4 py-4 text-sm overflow-y-auto space-y-1">

      <!-- QUẢN LÝ KHO (Mặc định) -->
      <div class="menu-title mt-2">QUẢN LÝ KHO</div>
      <button onclick="switchTab('kho', this)" class="menu-btn active">
        <i class="fa-solid fa-mobile-screen-button w-5"></i>
        Kho Máy
      </button>
      <button onclick="switchTab('phukien', this)" class="menu-btn">
        <i class="fa-solid fa-plug w-5"></i>
        Kho Phụ Kiện
      </button>

      <!-- KINH DOANH -->
      <div class="menu-title mt-4">KINH DOANH</div>
      <button onclick="switchTab('checkdonhang', this)" class="menu-btn">
        <i class="fa-solid fa-magnifying-glass w-5"></i>
        Check Đơn Hàng
      </button>
      <button onclick="switchTab('donhang', this)" class="menu-btn">
        <i class="fa-solid fa-file-invoice-dollar w-5"></i>
        Đơn Hàng & BH
      </button>
      <button onclick="switchTab('khachhang', this)" class="menu-btn">
        <i class="fa-solid fa-users w-5"></i>
        Khách Hàng
      </button>

      <!-- DỊCH VỤ -->
      <div class="menu-title mt-4">DỊCH VỤ</div>
      <button onclick="switchTab('repair', this)" class="menu-btn">
        <i class="fa-solid fa-screwdriver-wrench w-5"></i>
        Sửa Chữa
      </button>
      
      <!-- BẢO HÀNH -->
      <button onclick="switchTab('baohanh', this)" class="menu-btn">
        <i class="fa-solid fa-shield-halved w-5"></i>
        Bảo Hành & Lỗi
      </button>

      <!-- MỤC MỚI: BẢNG GIÁ SỬA CHỮA -->
      <button onclick="switchTab('banggiasua', this)" class="menu-btn">
        <i class="fa-solid fa-tags w-5"></i>
        Bảng Giá Sửa Chữa
      </button>

    </nav>

    <!-- LOGOUT -->
    <div class="p-4 border-t">
      <button onclick="logout()"
        class="flex items-center gap-3 text-red-500 hover:bg-red-50
               w-full px-4 py-3 rounded-xl font-bold">
        <i class="fa-solid fa-right-from-bracket"></i>
        Đăng xuất
      </button>
    </div>
  </aside>

  <!-- MAIN -->
  <main class="flex-1 flex flex-col bg-gray-50">

    <!-- TOP BAR -->
    <header class="h-16 bg-white border-b flex items-center justify-between px-6">
      <div class="flex items-center gap-3">
        <button onclick="toggleSidebar()" class="md:hidden">
          <i class="fa-solid fa-bars text-xl"></i>
        </button>
        <h2 id="pageTitle" class="text-lg font-bold text-gray-800">
          Quản Lý Kho Máy
        </h2>
      </div>

      <div class="flex items-center gap-3">
        <div class="text-right">
          <div id="nvName" class="text-sm font-bold text-gray-700"></div>
          <div class="text-xs text-green-600 font-medium">Online</div>
        </div>
        <div class="w-9 h-9 bg-green-100 text-green-600 rounded-full
                    flex items-center justify-center font-bold">
          NV
        </div>
      </div>
    </header>

    <!-- IFRAME AREA -->
    <div class="flex-1 relative overflow-hidden bg-gray-50">
      
      <!-- Kho Máy (Mặc định hiển thị) -->
      <iframe id="frame_kho" src="kho.html" class="app-frame"></iframe>
      
      <!-- Các iframe khác (Ẩn) -->
      <iframe id="frame_phukien" src="phukien.html" class="app-frame hidden"></iframe>
      <iframe id="frame_checkdonhang" src="checkdonhang.html" class="app-frame hidden"></iframe>
      <iframe id="frame_donhang" src="donhang.html" class="app-frame hidden"></iframe>
      <iframe id="frame_khachhang" src="khachhang.html" class="app-frame hidden"></iframe>
      <iframe id="frame_repair" src="repair.html" class="app-frame hidden"></iframe>
      <iframe id="frame_baohanh" src="baohanh.html" class="app-frame hidden"></iframe>
      
      <!-- MỤC MỚI: FRAME BẢNG GIÁ SỬA CHỮA -->
      <iframe id="frame_banggiasua" src="banggiasua.html" class="app-frame hidden"></iframe>
    </div>

  </main>
</div>

<!-- STYLE -->
<style>
.menu-title{
  padding: 12px 10px 6px;
  font-size: 11px;
  font-weight: 700;
  letter-spacing: .08em;
  color: #9ca3af;
}

.menu-btn{
  display:flex;
  align-items:center;
  gap:12px;
  padding:12px 14px;
  border-radius:14px;
  transition:.2s;
  color:#374151;
  width: 100%;
  text-align: left;
}
.menu-btn:hover{
  background:#f3f4f6;
}
.menu-btn.active{
  background:#ecfdf5;
  color:#166534;
  font-weight:700;
}
.menu-btn.active i{
  color:#16a34a;
}

.app-frame{
  position:absolute;
  inset:0;
  width:100%;
  height:100%;
  border:none;
}
.hidden{display:none !important;}
</style>

<!-- SCRIPT -->
<script>
/* ================= AUTH ================= */
const NV_ID  = localStorage.getItem("NV_ID");
const NV_TEN = localStorage.getItem("NV_TEN");

if (!NV_ID || !NV_TEN) {
  location.href = "login.html";
}

document.getElementById("nvName").innerText =
  `NV${NV_ID} - ${NV_TEN}`;

window.CURRENT_NV_ID   = NV_ID;
window.CURRENT_NV_NAME = NV_TEN;

/* ================= UI ================= */
function toggleSidebar(){
  sidebar.classList.toggle("-translate-x-full");
  overlay.classList.toggle("hidden");
}

function switchTab(tab, btn){
  // 1. Ẩn tất cả frame
  document.querySelectorAll(".app-frame")
    .forEach(f=>f.classList.add("hidden"));

  // 2. Hiện frame được chọn (iframe hoặc div thông báo)
  document.getElementById("frame_"+tab)
    ?.classList.remove("hidden");

  // 3. Cập nhật trạng thái nút menu
  document.querySelectorAll(".menu-btn")
    .forEach(b=>b.classList.remove("active"));

  btn?.classList.add("active");

  // 4. Đổi tiêu đề trang
  const titleMap={
    kho:"Quản Lý Kho Máy",
    phukien:"Kho Phụ Kiện",
    checkdonhang:"Check Đơn Hàng",
    donhang:"Đơn Hàng & Bảo Hành",
    khachhang:"Khách Hàng",
    repair:"Sửa Chữa",
    baohanh:"Bảo Hành & Máy Lỗi",
    banggiasua:"Bảng Giá Sửa Chữa" // Tiêu đề mới
  };
  pageTitle.innerText = titleMap[tab] || "Apple Store";

  // 5. Đóng sidebar trên mobile
  if(innerWidth < 768) toggleSidebar();
}

/* ================= LOGOUT ================= */
function logout(){
  localStorage.clear();
  location.href="/";
}
</script>

</body>
</html>